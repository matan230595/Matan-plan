<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Panda Planner — יומי/שבועי/חודשי (Mobile‑First)</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="app-header">
      <div class="left-group">
        <button id="menuToggle" class="hamburger" aria-label="פתח תפריט">☰</button>
        <h1 class="brand">Panda Planner</h1>
      </div>
      <div class="right-group">
        <div class="controls two-rows">
          <div class="row">
            <button id="darkModeToggle" class="small" aria-label="החלף מצב כהה">🌙 מצב כהה</button>
            <button id="openSettingsBtn" class="small">הגדרות</button>
            <button id="undoBtn" class="small" disabled>ביטול</button>
            <button id="redoBtn" class="small" disabled>חזרה</button>
            <button id="openCreateBtn" class="primary">+ בלוק חדש</button>
          </div>
          <div class="row">
            <button id="exportJsonBtn" class="small">ייצא JSON</button>
            <button id="exportCsvBtn" class="small">ייצא CSV</button>
            <button id="exportIcsBtn" class="small">ייצא ICS</button>
            <button id="printBtn" class="small">הדפס PDF</button>
            <button id="importJsonBtn" class="small">ייבוא JSON</button>
            <button id="importCsvBtn" class="small">ייבוא CSV</button>
          </div>
        </div>
      </div>
    </header>

    <!-- Top navigation -->
    <section class="top-nav">
      <div class="view-tabs">
        <button class="tab active" data-view="week">שבועי</button>
        <button class="tab" data-view="day">יומי</button>
        <button class="tab" data-view="month">חודשי</button>
      </div>
      <div class="date-controls">
        <span id="currentRange" class="range-label"></span>
        <div class="date-buttons">
          <button id="prevRange" class="small">← הקודם</button>
          <button id="nextRange" class="small">הבא →</button>
          <button id="goToday" class="small">חזור להיום</button>
          <button id="goThisWeek" class="small">חזור לשבוע הנוכחי</button>
        </div>
      </div>
    </section>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-header">
        <div class="title">תפריט</div>
        <button id="sidebarClose" class="small">סגור ✕</button>
      </div>

      <div class="section">
        <div class="section-title">תבניות מהירות</div>
        <div id="templatesList" class="templates-list"></div>
      </div>

      <div class="section">
        <div class="section-title">בלוקים קבועים</div>
        <div id="fixedBlocks" class="fixed-blocks">
          <button class="chip" data-type="work">שעות עבודה</button>
          <button class="chip" data-type="sleep">שעות שינה</button>
          <button class="chip" data-type="family">זמן משפחה</button>
          <button class="chip" data-type="free">זמן פנאי</button>
          <button class="chip" data-type="study">למידה</button>
        </div>
      </div>

      <div class="section">
        <div class="section-title">ייצוא/ייבוא</div>
        <div class="export-group">
          <button id="exportJsonBtnAside" class="small">JSON</button>
          <button id="exportCsvBtnAside" class="small">CSV</button>
          <button id="exportIcsBtnAside" class="small">ICS</button>
          <button id="printBtnAside" class="small">PDF</button>
          <button id="importJsonBtnAside" class="small">ייבוא JSON</button>
          <button id="importCsvBtnAside" class="small">ייבוא CSV</button>
        </div>
      </div>

      <div class="section">
        <div class="section-title">הגדרות מהירות</div>
        <div class="zoom-group">
          <label for="zoomRange">זום אנכי</label>
          <input id="zoomRange" type="range" min="20" max="120" step="1" value="40" />
          <div class="zoom-meta">
            <span>גובה שורה: <strong id="zoomLabel">40</strong> px</span>
            <button id="zoomReset" class="small">ברירת מחדל</button>
          </div>
        </div>
      </div>

      <div class="sidebar-footer">גרור תבנית אל הגריד כדי להוסיף אירוע. לחץ כפול על בלוק לעריכה.</div>
    </aside>

    <!-- Main views -->
    <main id="view-container">
      <!-- Week view -->
      <section id="week-view" class="panel">
        <div id="grid-root"></div>
        <div id="summary-panel" class="summary-panel">
          <div class="summary-header">
            <div class="title">סיכום שבועי</div>
            <div class="actions">
              <button id="exportSummaryCsv" class="small">יצוא Excel</button>
              <button id="exportSummaryPdf" class="small">יצוא PDF</button>
              <button id="printSummary" class="small">הדפס תמצית</button>
            </div>
          </div>
          <div class="earnings-overview">
            <div class="earn-widget">
              <div class="label">סך שעות בשבוע</div>
              <div id="total-hours" class="value">0.00</div>
            </div>
            <div class="earn-widget">
              <div class="label">סה"כ הכנסה (₪)</div>
              <div id="total-income" class="value">0.00 ₪</div>
            </div>
            <div class="earn-widget">
              <div class="label">שכר ממוצע (₪/שעה)</div>
              <div id="avg-rate" class="value">0.00 ₪/שעה</div>
            </div>
          </div>
          <div id="summaryCards" class="summary-grid"></div>
        </div>
      </section>

      <!-- Day view -->
      <section id="day-view" class="panel hidden">
        <div class="panel-header">
          <div id="dayTitle" class="title">תצוגה יומית</div>
          <div class="actions">
            <button id="prevDay" class="small">← יום קודם</button>
            <button id="nextDay" class="small">יום הבא →</button>
          </div>
        </div>
        <div class="day-columns">
          <div id="dayHours" class="day-hours"></div>
          <div id="dayCanvas" class="day-canvas"></div>
        </div>
      </section>

      <!-- Month view -->
      <section id="month-view" class="panel hidden">
        <div class="panel-header">
          <div id="monthTitle" class="title">תצוגה חודשית</div>
          <div class="actions">
            <button id="prevMonth" class="small">← חודש קודם</button>
            <button id="nextMonth" class="small">חודש הבא →</button>
          </div>
        </div>
        <div id="monthGrid" class="month-grid"></div>
      </section>
    </main>
  </div>

  <!-- Floating Action Button -->
  <button id="fab" class="fab" aria-label="הוסף בלוק">+</button>

  <!-- Modals -->
  <div id="create-backdrop" class="modal-backdrop"></div>
  <div id="create-modal" class="modal-panel">
    <h2>יצירת בלוק חדש</h2>
    <label>שם הבלוק</label><input id="cb-name" type="text" placeholder="פגישה עם לקוח" />
    <label>קטגוריה</label>
    <select id="cb-type">
      <option value="business">עסקי</option>
      <option value="personal">אישי</option>
      <option value="study">למידה</option>
      <option value="health">בריאות</option>
      <option value="other">אחר</option>
    </select>
    <label>משך</label>
    <div class="dur-btns" id="durBtns">
      <button class="dur-btn" data-duration="0.5">חצי שעה</button>
      <button class="dur-btn" data-duration="1">שעה</button>
      <button class="dur-btn" data-duration="1.5">שעה וחצי</button>
      <button class="dur-btn" data-duration="2">שעתיים</button>
      <button class="dur-btn" data-duration="3">3 שעות</button>
      <button class="dur-btn" data-duration="4">4 שעות</button>
    </div>
    <label>תאריך ושעת התחלה</label>
    <div class="row-inline">
      <input id="cb-date" type="date" />
      <input id="cb-start" type="number" step="0.25" placeholder="8.25 = 08:15" />
    </div>
    <div class="row-inline">
      <label><input id="cb-income" type="checkbox" /> הבלוק מביא הכנסה</label>
    </div>
    <div id="cb-rate-row" class="row-inline" style="display:none">
      <label>שכר שעתי (₪)</label>
      <input id="cb-rate" type="number" min="0" step="0.01" />
    </div>
    <label>הערות</label><textarea id="cb-notes" class="notes"></textarea>
    <div class="modal-actions">
      <div class="left">
        <button id="createBlockBtn" class="primary">צור בלוק +</button>
        <button id="saveTemplateBtn" class="small">שמור כתבנית</button>
      </div>
      <div id="cb-earning-preview" class="muted"></div>
    </div>
  </div>

  <div id="edit-backdrop" class="modal-backdrop"></div>
  <div id="edit-modal" class="modal-panel">
    <h3>עריכת בלוק</h3>
    <label>שם</label><input id="edit-name" type="text" />
    <label>תאריך</label><input id="edit-date" type="date" />
    <label>שעת התחלה (עשרוני)</label><input id="edit-start" type="number" step="0.25" />
    <label>משך (בשעות)</label><input id="edit-duration" type="number" step="0.25" />
    <div class="row-inline">
      <label><input id="edit-income" type="checkbox" /> הבלוק מביא הכנסה</label>
    </div>
    <div id="edit-rate-row" class="row-inline" style="display:none">
      <label>שכר שעתי (₪)</label><input id="edit-rate" type="number" step="0.01" />
    </div>
    <label>קטגוריה</label>
    <select id="edit-type">
      <option value="business">עסקי</option>
      <option value="personal">אישי</option>
      <option value="study">למידה</option>
      <option value="health">בריאות</option>
      <option value="other">אחר</option>
    </select>
    <label>הערות</label><textarea id="edit-notes" class="notes"></textarea>
    <div class="modal-actions">
      <div class="left">
        <button id="edit-save" class="small">שמור</button>
        <button id="edit-cancel" class="small">בטל</button>
      </div>
      <button id="edit-delete" class="danger">מחק</button>
    </div>
  </div>

  <div id="settings-backdrop" class="modal-backdrop"></div>
  <div id="settings-modal" class="modal-panel">
    <h3>הגדרות דף</h3>
    <div class="settings-grid">
      <label>שעת תחלה</label><input id="setting-hours-start" type="number" min="0" max="23" />
      <label>שעת סיום</label><input id="setting-hours-end" type="number" min="1" max="24" />
      <label>גובה שורה (px)</label><input id="setting-row-height" type="number" min="16" max="200" />
      <label>דיוק רשת</label>
      <select id="setting-quant">
        <option value="0.25">15 דקות</option>
        <option value="0.0833333333">5 דקות</option>
        <option value="0.0166666667">1 דקה</option>
      </select>
      <label>היצמדות לבלוקים</label>
      <select id="setting-snap">
        <option value="off">כבוי</option>
        <option value="5">5 דקות</option>
        <option value="2">2 דקות</option>
        <option value="1">1 דקה</option>
      </select>
      <label>הפעל שדה שכר שעתי</label><label><input id="setting-enable-hourly" type="checkbox" /> מופעל</label>
    </div>
    <div class="modal-actions end">
      <button id="settings-reset" class="small">אפס ברירת מחדל</button>
      <button id="settings-apply" class="primary">שמור והחל</button>
    </div>
  </div>

  <!-- Hidden inputs for import -->
  <input type="file" id="importFileInput" accept=".json" style="display:none" />
  <input type="file" id="importCsvInput" accept=".csv" style="display:none" />

  <script src="app.js"></script>
</body>
</html>
